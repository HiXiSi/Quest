# 资料管理平台 - 运行与部署指南

## 项目概述

资料管理平台是一个功能完整的前后端分离Web应用，用于管理结构化数据和非结构化文件。项目采用Go + Vue3的技术栈，提供文件分类、标签管理、文件上传、预览、权限控制等功能。

## 技术栈

### 后端
- **语言：** Go 1.21+
- **框架：** Gin Web框架
- **数据库：** SQLite（可扩展为PostgreSQL）
- **ORM：** GORM
- **认证：** JWT Token
- **文件处理：** 支持多种文件格式

### 前端
- **框架：** Vue 3 + Composition API
- **构建工具：** Vite
- **UI组件库：** Element Plus
- **状态管理：** Pinia
- **HTTP客户端：** Axios

## 环境要求

### 开发环境
- Go 1.21 或更高版本
- Node.js 18 或更高版本
- npm 或 yarn

### 生产环境
- Go 运行时环境
- Web服务器（如Nginx）
- 反向代理配置

## 快速开始

### 1. 克隆项目

```bash
git clone <repository-url>
cd 21z
```

### 2. 后端启动

```bash
# 进入后端目录
cd backend

# 配置Go代理（国内用户）
go env -w GOPROXY=https://goproxy.cn,direct
go env -w GOSUMDB=sum.golang.google.cn

# 下载依赖
go mod tidy

# 启动后端服务
go run main.go
```

后端服务将在 `http://localhost:8080` 启动

### 3. 前端启动

```bash
# 进入前端目录
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

前端服务将在 `http://localhost:3000` 启动

### 4. 访问应用

打开浏览器访问 `http://localhost:3000`

**默认管理员账号：**
- 用户名: `admin`
- 密码: `admin123`

## 功能特性

### 核心功能
1. **用户管理系统**
   - 用户注册、登录
   - JWT Token认证
   - 权限控制（普通用户/管理员）

2. **文件管理功能**
   - 多文件上传、拖拽上传
   - 文件分类和标签管理
   - 文件预览（图片、PDF、文本）
   - 文件下载和删除
   - 回收站功能

3. **分类管理**
   - 树状结构分类
   - 分类的增删改查
   - 分类图标和颜色自定义

4. **标签管理**
   - 标签的创建和管理
   - 文件标签关联
   - 热门标签统计

5. **文件安全**
   - MD5和SHA256哈希验证
   - 文件类型检测
   - 文件大小限制（100MB）

### 高级功能
- 文件在线预览
- 批量操作
- 搜索和筛选
- 系统统计信息
- 响应式界面设计

## 项目结构

```
21z/
├── backend/                 # 后端Go代码
│   ├── config/             # 数据库配置
│   ├── controllers/        # 控制器
│   ├── middlewares/        # 中间件
│   ├── models/            # 数据模型
│   ├── routes/            # 路由配置
│   ├── utils/             # 工具函数
│   ├── go.mod             # Go模块配置
│   └── main.go            # 主入口文件
├── frontend/               # 前端Vue代码
│   ├── src/
│   │   ├── components/    # 组件
│   │   ├── router/        # 路由配置
│   │   ├── stores/        # 状态管理
│   │   ├── utils/         # 工具函数
│   │   ├── views/         # 页面组件
│   │   ├── App.vue        # 根组件
│   │   └── main.js        # 入口文件
│   ├── package.json       # 依赖配置
│   └── vite.config.js     # Vite配置
├── uploads/               # 文件上传目录
├── static/               # 静态文件目录
├── .gitignore           # Git忽略文件
└── API文档.md           # API接口文档
```

## 配置说明

### 后端配置

1. **数据库配置** (`backend/config/database.go`)
   - 默认使用SQLite数据库
   - 数据库文件位置: `../static/database.db`
   - 支持自动迁移数据表

2. **JWT配置** (`backend/utils/auth.go`)
   - JWT密钥: `material-platform-secret-key`
   - Token过期时间: 24小时

3. **文件上传配置**
   - 上传目录: `../uploads`
   - 文件大小限制: 100MB
   - 支持的文件类型: 图片、文档、音视频等

### 前端配置

1. **API代理配置** (`frontend/vite.config.js`)
   - 开发环境API代理到 `http://localhost:8080`

2. **路由配置** (`frontend/src/router/index.js`)
   - 支持路由守卫
   - 权限验证

## 生产部署

### 1. 后端部署

```bash
# 编译Go程序
cd backend
go build -o material-platform main.go

# 运行
./material-platform
```

### 2. 前端部署

```bash
# 构建前端
cd frontend
npm run build

# 部署dist目录到Web服务器
```

### 3. Nginx配置示例

```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    # 前端静态文件
    location / {
        root /path/to/frontend/dist;
        try_files $uri $uri/ /index.html;
    }
    
    # 后端API代理
    location /api/ {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
    
    # 文件上传和下载
    location /uploads/ {
        proxy_pass http://localhost:8080;
    }
}
```

## 开发指南

### 添加新功能

1. **后端开发**
   - 在 `models/` 目录添加数据模型
   - 在 `controllers/` 目录添加控制器
   - 在 `routes/routes.go` 添加路由

2. **前端开发**
   - 在 `views/` 目录添加页面组件
   - 在 `router/index.js` 添加路由
   - 在 `utils/api.js` 添加API调用

### 代码规范

- 后端遵循Go官方代码规范
- 前端遵循Vue 3官方风格指南
- 使用统一的错误处理和响应格式

## 常见问题

### 1. Go模块下载失败
```bash
# 设置国内代理
go env -w GOPROXY=https://goproxy.cn,direct
go env -w GOSUMDB=sum.golang.google.cn
```

### 2. 前端依赖安装失败
```bash
# 使用国内源
npm config set registry https://registry.npmmirror.com
```

### 3. 数据库连接问题
- 确保 `static` 目录存在
- 检查数据库文件权限

### 4. 文件上传失败
- 确保 `uploads` 目录存在且有写权限
- 检查文件大小是否超过限制

## 安全注意事项

1. **生产环境配置**
   - 修改默认JWT密钥
   - 使用HTTPS协议
   - 配置防火墙规则

2. **文件安全**
   - 定期备份数据库
   - 监控磁盘空间使用
   - 设置文件访问权限

3. **用户安全**
   - 强制用户使用强密码
   - 定期更新依赖包
   - 监控异常访问

## 许可证

本项目采用 MIT 许可证，详情请参阅 LICENSE 文件。

## 技术支持

如果您在使用过程中遇到问题，请：

1. 查看本文档的常见问题部分
2. 检查API文档了解接口使用方法
3. 查看项目日志文件排查错误

## 版本历史

- v1.0.0: 初始版本，包含核心功能
  - 用户管理系统
  - 文件上传和管理
  - 分类和标签管理
  - 文件预览功能
  - 回收站功能
  - 现代化前端界面